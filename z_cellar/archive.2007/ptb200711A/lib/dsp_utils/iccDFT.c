/*-------------------------------UNCLASSIFIED---------------------------------*/
// File: iccDFT.c
// Desc: This file contains the code for the DSPUtils routine iccDFT.
// Hist: When       Who  What
//       07/27/2001 ptb  Initial Code.
/*----------------------------------------------------------------------------*/
/* Preprocessor directives ---------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Include files -------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
#include "dsp_utils.h" 
 
/* Constants -----------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Type defines --------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Macros --------------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Prototypes ----------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Routines ------------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

/* Real DFT ------------------------------------------------------------------*/
//  for kk = 0:N-1;
//    for nn = 0:N-1;
//      y(kk+1) = y(kk+1) + x(nn+1).*(cos(nn*kk*2*pi/N)+sin(nn*kk*2*pi/N)*j);
//    endfor
//  endfor

VOID iccDFTFLT32_R(FLT32 *iData, // Real Input
		   FLT32 *oData, // Complex output
		   UNT32 n)
{

  FLT32 C = 2*PI/((FLT32)n);
  INT32 ii,jj,kk;

  for (ii=0; ii<n; ii++)
  {
    kk = ii*2;
    oData[kk  ]=0.0;
    oData[kk+1]=0.0;

    for(jj=0; jj<n; jj++)
    {
      oData[kk  ] = oData[kk  ] + iData[jj]*cos( ii*jj*C );
      oData[kk+1] = oData[kk+1] + iData[jj]*sin( ii*jj*C );
    }
  }
}

/* Complex DFT ---------------------------------------------------------------*/
//  for kk = 0:N-1;
//    for nn = 0:N-1;
//      y(kk+1) = y(kk+1) + x(nn+1).*(cos(nn*kk*2*pi/N)+sin(nn*kk*2*pi/N)*j);
//    endfor
//  endfor

VOID iccDFTFLT32_C(FLT32 *iData, // Complex Input
		   FLT32 *oData, // Complex output
		   UNT32 n)
{

  FLT32 C = 2*PI/((FLT32)n);
  INT32 ii,jj,kk,ll;

  for (ii=0; ii<n; ii++)
  {
    kk = ii*2;
    oData[kk  ]=0.0;
    oData[kk+1]=0.0;

    for(jj=0; jj<n; jj++)
    {
      ll = jj*2;
      oData[kk  ] = oData[kk  ] + iData[ll  ]*cos( ii*jj*C )+iData[ll+1]*sin( ii*jj*C );
      oData[kk+1] = oData[kk+1] - iData[ll+1]*cos( ii*jj*C )-iData[ll  ]*sin( ii*jj*C );
    }
  }
}                                                                                                                                                                   
/* End preprocessor directives -----------------------------------------------*/
/*----------------------------------------------------------------------------*/
/*-------------------------------UNCLASSIFIED---------------------------------*/


