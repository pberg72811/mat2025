/*-------------------------------UNCLASSIFIED---------------------------------*/
// File: xccStreamSocketOpen.c
// Desc: This file contains the code for the xccStreamSocketOpen routine.
// Hist: When       Who  What
//       05/20/2002 ptb  Initial Code.
/*----------------------------------------------------------------------------*/
/* Preprocessor directives ---------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Include files -------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
#include "socket_utils.h"

/* Constants -----------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Type defines --------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Macros --------------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Prototypes ----------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
/* Routines ------------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
INT16 xccStreamSocketOpen(const CHR08 *nameOrAddress, INT32 port)
{
  INT16 socketFD;
  struct hostent *he;
  struct sockaddr_in their_addr;

// gethostbyname
//------------------------------------------------------------------------------
  if( (he=gethostbyname(nameOrAddress)) == NULL )
  {
    perror("ERROR xccStreamSocketOpen: gethostbyname.");
    exit(1);
  }

// Open a socket.
//------------------------------------------------------------------------------
  if( (socketFD = socket(AF_INET, SOCK_STREAM, 0))== -1)
  {
    perror("ERROR xccStreamSocketOpen:  socket.");
    exit(1);
  }
  
// Set parameters.
//------------------------------------------------------------------------------
  their_addr.sin_family = AF_INET;
  their_addr.sin_port = htons(port);
  their_addr.sin_addr = *((struct in_addr *) he->h_addr);
  memset( &(their_addr.sin_zero),0, 8);
  
// Connect to socket.
//------------------------------------------------------------------------------
  if( connect(socketFD, (struct sockaddr *)&their_addr, sizeof(struct sockaddr)) == -1)
  {
    perror("ERROR xccStreamSocketOpen:  connect");
    return(0);
  }

// Return sock file descriptor "socketFD".
//------------------------------------------------------------------------------
  return(socketFD);
}

/* End preprocessor directives -----------------------------------------------*/
/*----------------------------------------------------------------------------*/

/*-------------------------------UNCLASSIFIED---------------------------------*/
