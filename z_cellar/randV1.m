% [r_, v_] = randV1(11067.790, 0.83285, 87.87, 227.89, 53.38, 92.335)

function [r_, v_] = randV1( p, e, i_, O, o, nu )
%-------------------------------------------------------------------------------------------------
% p. 125
% "p" needs to be Canonical.  That is divided by AU or ER or whatever.
%
   x = p * cosd(nu) / (1 + e * cosd(nu));
   y = p * sind(nu) / (1 + e * cosd(nu));
   z = 0.0;

   vx = -sqrt(1./p).*sind(nu);
   vy = +sqrt(1./p).*(e + cosd(nu));
   vz = 0;

   r_ = ROT3d(-O) * ROT1d(-i_) * ROT3d(-o) * [x; y; z];
   v_ = ROT3d(-O) * ROT1d(-i_) * ROT3d(-o) * [vx; vy; vz];
   
end

%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
% Supporting Functions.
%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------

function ROT1 = ROT1d(a) 
%-------------------------------------------------------------------------------------------------
   ROT1 = SOLAR.ROT1r( deg2rad(a) );
end

% function ROT2 = ROT2d(a)   *** NOT USED IN THIS FUNCTION ***
% %-----------------------------------------------------------------------------------------------
%    ROT2 = SOLAR.ROT2r( deg2rad(a) );
% end

function ROT3 = ROT3d(a)
%-------------------------------------------------------------------------------------------------
   ROT3 = SOLAR.ROT3r( deg2rad(a) );
end 




















% function ROT1_ = ROT1d(a)
% %
% % 168
% %
%    ROT1_ = [     1        0        0 ;
%                  0 +cosd(a) +sind(a) ;
%                  0 -sind(a) +cosd(a)];
% end
% 
% function ROT2_ = ROT2d(a)
% %
% %
% %
%    ROT2_ = [+cosd(a)      0 -sind(a) ;
%                    0      1        0 ;
%             +sind(a)      0 +cosd(a)];
% end
% 
% function ROT3_ = ROT3d(a)
% %
% %
% %
%    ROT3_ = [+cosd(a) +sind(a)      0 ;
%             -sind(a) +cosd(a)      0 ;
%                    0        0      1];
% end